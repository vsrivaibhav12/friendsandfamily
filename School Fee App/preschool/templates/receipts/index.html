{% extends 'base.html' %}
{% block content %}
<div class="card">
  <div class="card-title-row">
    <h2>Receipts</h2>
    <a class="btn" href="{{ url_for('receipts.new_receipt') }}">Collect Fee</a>
  </div>

  <form method="get" class="toolbar">
    <input name="q" placeholder="Search by receipt no. or student name" value="{{ q }}">
    <button class="btn">Search</button>
  </form>

  <table class="table" style="margin-top:10px">
    <thead><tr><th>Receipt #</th><th>Date/Time</th><th>Student</th><th>Mode</th><th style="text-align:right">Amount</th><th></th></tr></thead>
    <tbody>
      {% for r in rows %}
      <tr>
        <td>{{ r.receipt_no }}</td>
        <td>{{ r.created_at.strftime('%Y-%m-%d %H:%M') if r.created_at else '' }}</td>
        <td>{{ r.student.name if r.student else '' }}</td>
        <td>{{ r.mode }}</td>
        <td style="text-align:right">â‚¹ {{ '%.2f'|format(r.amount or 0) }}</td>
        <td><a class="btn small" target="_blank" href="{{ url_for('receipts.print_receipt', id=r.id) }}">Print</a></td>
      </tr>
      {% endfor %}
      {% if rows|length == 0 %}
      <tr><td colspan="6" class="muted">No receipts found.</td></tr>
      {% endif %}
    </tbody>
  </table>
</div>
{% endblock %}
