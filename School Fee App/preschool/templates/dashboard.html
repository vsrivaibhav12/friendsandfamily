{% extends 'base.html' %}
{% block content %}
<div class="stat-grid">
  <div class="stat">
    <div class="icon">üì•</div>
    <div><div class="num">‚Çπ {{ '%.2f'|format(receivable) }}</div><div class="muted">Receivable</div></div>
  </div>
  <div class="stat">
    <div class="icon">‚úÖ</div>
    <div><div class="num">‚Çπ {{ '%.2f'|format(received) }}</div><div class="muted">Received (all time)</div></div>
  </div>
  <div class="stat">
    <div class="icon">‚ö†Ô∏è</div>
    <div><div class="num">‚Çπ {{ '%.2f'|format(balance) }}</div><div class="muted">Balance</div></div>
  </div>
</div>

<div class="card" style="margin-top:16px">
  <div class="card-title-row">
    <h3>Students with Balance (Top 10)</h3>
    <a class="btn small" href="{{ url_for('reports.overdue') }}">Full report</a>
  </div>
  <table class="table">
    <thead><tr><th>Adm No</th><th>Name</th><th>Class</th><th>Phone</th><th style="text-align:right">Balance</th><th></th></tr></thead>
    <tbody>
    {% for s, bal in students_outstanding %}
      <tr>
        <td>{{ s.admission_no }}</td>
        <td>{{ s.name }}</td>
        <td>{{ s.class_name }} {{ s.section }}</td>
        <td>{{ s.phone }}</td>
        <td style="text-align:right">‚Çπ {{ '%.2f'|format(bal) }}</td>
        <td><a class="btn small" href="{{ url_for('students.student_card', id=s.id) }}">Card</a></td>
      </tr>
    {% endfor %}
    {% if students_outstanding|length == 0 %}
      <tr><td colspan="6" class="muted">All clear ‚Äî no balances due üéâ</td></tr>
    {% endif %}
    </tbody>
  </table>
</div>
{% endblock %}
