{% extends 'base.html' %}
{% block content %}
<div class="card">
  <h2>Create Waiver</h2>
  <form method="post" class="grid-4">
    <div><label>Student</label><select name="student_id">{% for s in students %}<option value="{{ s.id }}">{{ s.name }}</option>{% endfor %}</select></div>
    <div><label>Fee Type</label><select name="fee_type_id">{% for t in types %}<option value="{{ t.id }}">{{ t.name }}</option>{% endfor %}</select></div>
    <div><label>Amount</label><input name="amount" type="number" step="0.01" placeholder="0.00"></div>
    <div><label>Percent</label><input name="percent" type="number" step="0.01" placeholder="0.00"></div>
    <div class="grid-col-span-4"><label>Reason</label><input name="reason" placeholder="Reason for waiver"></div>
    <button class="btn primary">Create</button>
  </form>
</div>

<h3>Recent Waivers</h3>
<table class="table">
  <thead><tr><th>Date</th><th>Student</th><th>Fee Type</th><th>Amount</th><th>%</th><th>Approved</th><th>By</th><th></th></tr></thead>
  <tbody>
  {% for w in rows %}
  <tr>
    <td>{{ w.created_at.strftime('%Y-%m-%d') }}</td>
    <td>{{ w.student.name }}</td>
    <td>{{ w.fee_type.name if w.fee_type else '' }}</td>
    <td>{{ w.amount }}</td>
    <td>{{ w.percent }}</td>
    <td>{{ 'Yes' if w.approved else 'No' }}</td>
    <td>{{ w.approved_by or '' }}</td>
    <td>{% if not w.approved %}<form method="post" action="{{ url_for('waivers.approve', id=w.id) }}"><button class="btn small">Approve</button></form>{% endif %}</td>
  </tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
